{% extends "base.html" %}

{% block title %}
<title>Dojopy - Checkout Taller Python</title>
{% endblock %}

{% block preview_fb %}
    <!--FACEBOOK-->
    <meta property="og:image" content="/static/base/img/back_priview.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.dojopy.com"/>
    <meta property="og:title" content="Dojopy Mentor"/>
    <meta property="og:description" content="Aprende a Programar con tu Mentor de Cero a Ninja." />
{% endblock %}

{% block main_content %}

<section class="learning_part" >
    <div class="container">
        <div class="row align-items-sm-center align-items-lg-stretch">


            <div class="container">
                            <div class="row py-5">
                                <div class="col-md-4 order-md-2 mb-4">
                                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                                        <span class="text-muted">Carrito de Compras</span>
                                        <span class="badge badge-secondary badge-pill">1</span>
                                    </h4>
                                    <ul class="list-group mb-3">
                                        <li class="list-group-item d-flex justify-content-between lh-condensed">
                                            <div>
                                                <h6 class="my-0">Taller Python de Cero a Ninja</h6>
                                                <small class="text-muted">Dojopy</small>
                                            </div>
                                            <span style="color:#31de79" class="text-muted">$ 49</span>
                                        </li>

                                        <li class="list-group-item d-flex justify-content-between">
                                            <span>Total</span>
                                            <strong style="font-size:1rem; color:#31de79">$ 49</strong>
                                        </li>
                                    </ul>

                                </div>
                                <div class="col-md-8 order-md-1">
                                    <h4 style="font-size:1.8rem" class="mb-3">Tus Datos</h4>
                                        <div class="row">
                                            <div class="col-md-6 mb-3">
                                                <label for="firstName">Nombre</label>
                                                <input type="text" class="form-control" id="firstName" placeholder="" value="" required="">
                                                <div class="invalid-feedback">
                                                    Nombre es requerido.
                                                </div>
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="lastName">Apellido</label>
                                                <input type="text" class="form-control" id="lastName" placeholder="" value="" required="">
                                                <div class="invalid-feedback">
                                                    Apellido es requerido.
                                                </div>
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="lastName">Teléfono Móvil o Whatsapp</label>
                                                <input type="text" class="form-control" id="phone" placeholder="" value="" required="">
                                                <div class="invalid-feedback">
                                                    Teléfono Móvil es requerido.
                                                </div>
                                            </div>
                                        </div>


                                        <hr class="mb-4">

                                        <h4 class="mb-3">Selecciona tu Método de Pago</h4>

                                        <div class="d-block my-3">

                                            <div class="custom-control custom-radio">
                                                <input id="credit" name="paymentMethod" type="radio" class="custom-control-input" checked="" required="">
                                                <label style="cursor: pointer;" class="custom-control-label" for="credit"> Tarjeta
                                                    <img width="210" src="/static/base/img/metodo-pago.png" alt="">

                                                </label>
                                            </div>
                                            <hr>
                                            <div class="custom-control custom-radio">
                                                <input id="paypal" name="paymentMethod" type="radio" class="custom-control-input" required="">
                                                <label style="cursor: pointer;" class="custom-control-label" for="paypal"> Paypal
                                                    <img width="200" src="/static/base/img/metodo-paypal.png" alt="">
                                                </label>
                                            </div>
                                        </div>

                                        <br>
                                        <button id="buyButton" class="btn btn-success btn-lg btn-block">
                                            <i class="fa fa-credit-card"></i> PROCEDER PAGO</button>
                                </div>
                            </div>
                        </div>

        </div>
    </div>
</section>


{% endblock %}

{% block cont_mentores %}
{% endblock %}


{% block talleres %}
{% endblock %}

{% block info_dojopy %}
{% endblock %}

{% block stack_it %}
{% endblock %}

{% block my_script %}
<script src="https://checkout.culqi.com/js/v3"></script>
<script>


function send_tk(token){
        var firstName = $("#firstName").val()
        var lastName = $("#lastName").val()
        var phone = $("#phone").val()

        // console.log(firstName, lastName, Culqi.token.email);
         $.ajax({
               type: "POST",
               url : '/checkout',
               enctype: 'multipart/form-data',
               data: {
                      "token_payment_gateway": token,
                      "firstName": firstName,
                      "lastName": lastName,
                      "email": Culqi.token.email,
                      "phone": phone,
                      "tk_django": "{{tk_django}}"
                  },
               encode: true
           })
           .done(function(data){
               console.log("checkout ok");
               if (data.token_active){
                   console.log('checkout Ok');
                   window.location.href = '/checkout/success';
               }else{
                   console.log('checkout Error');
                   location.reload();
               }
           })
           .fail(function(data){
               console.log("checkout Error");
                });
}

function culqi() {
      if (Culqi.token) {
        var token = Culqi.token.id;
        send_tk(token)
      } else {
        console.log(Culqi.error);
      }
};

    Culqi.publicKey = 'pk_test_QfmMu2RtRgv6TEtg';
    Culqi.settings({
        title: "Taller Python de Cero a Ninja",
        currency: 'USD',
        description: "Taller Python de Cero a Ninja",
        amount: 49
    });
    Culqi.options({
    lang: 'auto',
    modal: true,
    installments: false,
    customButton: 'Pagar',
    style: {
      logo: 'https://dojopy.com/static/base/img/checkout-logo.png',
      maincolor: '#31de79',
      buttontext: '#ffffff',
      maintext: '#4A4A4A',
      desctext: '#4A4A4A'
    }
});

    $('#buyButton').on('click', function(e) {
        Culqi.open();
        e.preventDefault();
    });

</script>

{% endblock %}
